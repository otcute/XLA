<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../static/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <form action="" method="post" enctype="multipart/form-data" id="uploadForm">
        <div class="main">
            <div class="half mb3">
                <label for="formFile" class="form-label">CHOSE IMAGE</label>
                <input class="form-control" type="file" id="fileInput" onchange="previewImage()">

                <div class="showImg" style="display: block;">
                    <img id="imagePreview" alt="Image Preview" name="image"
                        style="max-width: 300px; max-height: 300px;">
                </div>

                <div class="convertImg" id="convertImg" style="display: block;">

                </div>
            </div>
            <div class="half">
                <div class="buttons">
                    <button class="button btn btn-danger">Negative Transform</button>
                    <button class="button btn btn-danger">Thresholding Image</button>
                    <button class="button btn btn-danger">Logarit Transform</button>
                    <button class="button btn btn-danger">Power Law Transform</button>
                    <button class="button btn btn-danger">Histogram Equalizing</button>
                    <button class="button btn btn-danger">Weighted Averaging</button>
                    <button class="button btn btn-danger">Median Filter</button>
                    <button class="button btn btn-danger">Roberts Operator</button>
                    <button class="button btn btn-danger">Sobel Operator</button>
                    <button class="button btn btn-danger">Laplacian Operator</button>
                    <button class="button btn btn-danger">Prewitt Operator</button>
                    <button class="button btn btn-danger">Canny Operator</button>
                    <button class="button btn btn-danger">Otsu Algorithm</button>
                    <button class="button btn btn-danger">Run-length Coding</button>
                    <!-- <button class="button btn btn-danger">LZW Coding</button> -->
                    <button class="button btn btn-danger">Erosion</button>
                    <button class="button btn btn-danger">Dilation</button>
                    <button class="button btn btn-danger">Opening</button>
                    <button class="button btn btn-danger">Closing</button>
                </div>
            </div>
        </div>

    </form>

    <script>
        function previewImage() {
            var fileInput = document.getElementById('fileInput');
            var imagePreview = document.getElementById('imagePreview');

            var file = fileInput.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    imagePreview.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        document.getElementById("uploadForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const imgInput = document.getElementById("fileInput");
            const formData = new FormData();
            formData.append("image", imgInput.files[0]);

            // Kiểm tra xem nút nào được bấm và gọi api tương ứng
            if (e.submitter.innerText === "Negative Transform") {
                axios.post("http://127.0.0.1:5000/api/negative", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            } 
            
            else if (e.submitter.innerText === "Thresholding Image") {
                axios.post("http://127.0.0.1:5000/api/threshold", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            } 
            
            else if (e.submitter.innerText === "Logarit Transform") {
                axios.post("http://127.0.0.1:5000/api/logarit", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Power Law Transform") {
                axios.post("http://127.0.0.1:5000/api/powerlow", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Histogram Equalizing") {
                axios.post("http://127.0.0.1:5000/api/histogram", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Average Filter") {
                axios.post("http://127.0.0.1:5000/api/average", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Weighted Averaging") {
                axios.post("http://127.0.0.1:5000/api/weight", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Median Filter") {
                axios.post("http://127.0.0.1:5000/api/median", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Roberts Operator") {
                axios.post("http://127.0.0.1:5000/api/roberts", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Sobel Operator") {
                axios.post("http://127.0.0.1:5000/api/sobels", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Laplacian Operator") {
                axios.post("http://127.0.0.1:5000/api/laplace", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Prewitt Operator") {
                axios.post("http://127.0.0.1:5000/api/prewitt", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Canny Operator") {
                axios.post("http://127.0.0.1:5000/api/canny", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Otsu Algorithm") {
                axios.post("http://127.0.0.1:5000/api/otsu", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Run-length Coding") {
                axios.post("http://127.0.0.1:5000/api/rlc", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "LZW Coding") {
                axios.post("http://127.0.0.1:5000/api/lzw", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Dilation") {
                axios.post("http://127.0.0.1:5000/api/dilate", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Erosion") {
                axios.post("http://127.0.0.1:5000/api/erosion", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Opening") {
                axios.post("http://127.0.0.1:5000/api/open", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            else if (e.submitter.innerText === "Closing") {
                axios.post("http://127.0.0.1:5000/api/close", formData, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                })
                    .then(function (response) {
                        document.getElementById('convertImg').innerHTML = `<img src="data:image/jpeg;base64,${response.data.image_data}" style="max-width: 300px; max-height: 300px;">`;
                        console.log(response.data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }
        });
    </script>
</body>

</html>